ReadInput   â† >â€¢file.Lines

Part1 â† {
    input   â† ReadInput ð•©
    dirs â† "^>v<"
    offsets â† âŸ¨Â¯1â€¿0, 0â€¿1, 1â€¿0, 0â€¿Â¯1âŸ©
    guardPosâ† âŠ‘/â—‹â¥ŠâŸœ(â†•â‰¢)âˆŠâŸœ"^>v<" input
    guardDirâ† âŠ‘dirsâŠguardPosâŠ‘input
    F â† {
        ð•Šboardâ€¿posâ€¿dir: '#'=posâŠ‘board ? â€¢Show '#'â€¿posâ€¿dirâ‹„{nextDirâ†(â‰ dirs)|dir+1â‹„âŸ¨board,            pos+nextDir(-â—‹(âŠ‘âŸœoffsets))dir, nextDirâŸ©} ;
        ð•Šboardâ€¿posâ€¿dir:                 â€¢Show '.'â€¿posâ€¿dirâ‹„                       âŸ¨'X'âŒ¾(posâŠ¸âŠ‘)board, pos+dirâŠ‘offsets,               dirâŸ©
    }
    boardâ€¿Â·â€¿Â· â† Fâ€¢_while_{ð•Šboardâ€¿posâ€¿dir: â€¢Show '?'â€¿posâ€¿dirâ‹„(âˆ§Â´posâ‰¥0)âˆ§(âˆ§Â´pos<â‰¢board)}inputâ€¿guardPosâ€¿guardDir
    â€¢Show board
    +Â´â¥Š'X'=board
}
part1test â† Part1 "day6testinput.txt"
â€¢Show part1test
! part1test = 41
part1result â† Part1 "day6input.txt"
â€¢Show part1result
! part1result = 4580

# _trace_ â† {label _ð•£_ F: {
#     ð•Šð•©:  â€¢Show "â†’"â€¿  labelâ€¿ð•©â‹„xâ†Fð•©â‹„ â€¢Show "â†"â€¿labelâ€¿xâ‹„x ;
#     ð•¨ð•Šð•©: â€¢Show "â†’"â€¿ð•¨â€¿labelâ€¿ð•©â‹„xâ†ð•¨Fð•©â‹„â€¢Show "â†"â€¿labelâ€¿xâ‹„x
# }}
_trace_ â† {label _ð•£_ F: {
    ð•Šð•©:  Fð•© ;
    ð•¨ð•Šð•©: ð•¨Fð•©
}}

Bitor â† {âŠ‘âŸ¨ð•¨âŸ©8â€¢bit._orâŸ¨ð•©âŸ©}
Bitand â† {âŠ‘âŸ¨ð•¨âŸ©8â€¢bit._andâŸ¨ð•©âŸ©}
Part2 â† {
    input   â† ReadInput ð•©
    dirs â† "^>v<"
    offsets â† âŸ¨Â¯1â€¿0, 0â€¿1, 1â€¿0, 0â€¿Â¯1âŸ©
    guardPosâ† âŠ‘/â—‹â¥ŠâŸœ(â†•â‰¢)âˆŠâŸœ"^>v<" input
    guardDirâ† âŠ‘dirsâŠguardPosâŠ‘input
    DirMarkValue â† 2âŠ¸â‹†
    DirMarkChar â† 'A'âŠ¸+
    DirMark â† DirMarkChar DirMarkValue
    AddMarks â† BitorâŒ¾(DirMarkCharâ¼)
    MarkPath â† (DirMarkâŠ£){
            ð•Š: âŠ‘ð•©âˆŠ".^" ? ð•¨ ;
                         ð•¨ AddMarks ð•©
        }âŠ¢
    MarkLoop â† {(â‰ dirs) MarkPath ð•¨ MarkPath ð•©}
    PathMatches â† {
              Â·ð•Š'.': 0 ;
              Â·ð•Š'#': 0 ;
                     0â‰¢(DirMarkValueð•¨) Bitand DirMarkCharâ¼ð•©
        }
    CurrentChar â† {ð•Šboardâ€¿posâ€¿dir: posâŠ‘board}
    InBounds â† {ð•Šboardâ€¿posâ€¿Â·: (âˆ§Â´posâ‰¥0)âˆ§(âˆ§Â´pos<â‰¢board)}
    HasMark â† {ð•Šboardâ€¿posâ€¿dir: InBounds ð•© ? dir PathMatches posâŠ‘board ; 0}
    IsLoop â† InBoundsâˆ˜({
            ð•Šboardâ€¿posâ€¿dir: '#'=posâŠ‘board ? â€¢Show "IsLoop"â€¿'#'â€¿posâ€¿dirâ‹„{nextDirâ†(â‰ dirs)|dir+1â‹„âŸ¨board,            pos+nextDir(-â—‹(âŠ‘âŸœoffsets))dir, nextDirâŸ©} ;
            ð•Šboardâ€¿posâ€¿dir:                 â€¢Show "IsLoop"â€¿'.'â€¿posâ€¿dirâ‹„âŸ¨(dirâŠ¸MarkPath)âŒ¾(posâŠ¸âŠ‘)board, pos+dirâŠ‘offsets, dirâŸ©
        }â€¢_while_ (InBoundsâˆ§(Â¬HasMark)))
    â€¢Show input
    F â† {
        ð•Šboardâ€¿posâ€¿dir: '#'=posâŠ‘board                       ? â€¢Show '#'â€¿posâ€¿dirâ‹„{nextDirâ†(â‰ dirs)|dir+1â‹„âŸ¨board,            pos+nextDir(-â—‹(âŠ‘âŸœoffsets))dir, nextDirâŸ©} ;
        ð•Šboardâ€¿posâ€¿dir: ('.'=posâŠ‘board) âˆ§ IsLoop âŸ¨'#'âŒ¾(posâŠ¸âŠ‘)board, pos, dirâŸ© ? â€¢Show 'O'â€¿posâ€¿dirâ‹„âŸ¨(dirâŠ¸MarkLoop)âŒ¾(posâŠ¸âŠ‘)board, pos+dirâŠ‘offsets, dirâŸ© ;
        ð•Šboardâ€¿posâ€¿dir:                                       â€¢Show '.'â€¿posâ€¿dirâ‹„âŸ¨(dirâŠ¸MarkPath)âŒ¾(posâŠ¸âŠ‘)board, pos+dirâŠ‘offsets, dirâŸ©
    }
    boardâ€¿Â·â€¿Â· â† Fâ€¢_while_ InBounds inputâ€¿guardPosâ€¿guardDir
    â€¢Show board
    +Â´(â‰ dirs)PathMatchesÂ¨â¥Šboard
}
part2test â† Part2 "day6testinput.txt"
â€¢Show part2test
! part2test = 6
part2result â† Part2 "day6input.txt"
â€¢Show part2result
 ! part2result = 1480
