ReadInput   â† â€¢file.Chars

# A parser is a function that takes a string and returns either an empty list or a pair containing the result and the remaining string.
MakeParser â† {
    f â‡ ğ•©
    Run â‡ F
}
_MapParserResult â† {
    ğ”½ _ğ•£ resultâ€¿rest: âŸ¨ğ”½ result, restâŸ© ;
    âŸ¨âŸ©
}
_MapParser â† {F _ğ•£ p:
    F2â†{F _MapParserResult p.Run ğ•©}
    MakeParser f2
}
parseChar â† {Fâ†{ğ•Šğ•©:0â‰ â‰ ğ•©?âŸ¨âŠ‘ğ•©,1â†“ğ•©âŸ©;âŸ¨âŸ©}â‹„MakeParser f}
ParseLiteral â† {ğ•Šs: Fâ†{(sâ‰¡(â‰ s)â†‘ğ•©)âŠ‘âŸ¨âŸ¨âŸ©,sâ‹ˆ(â‰ s)â†“ğ•©âŸ©}â‹„MakeParser f}
ParseRepeat â† {ğ•Šp:
    Fâ†{ğ•Šinput: {resultâ€¿rest: resultâŠ¸âˆ¾_MapParserResult F rest; âŸ¨âŸ¨âŸ©, inputâŸ©}p.Run input}
    MakeParser f
}
_ParseGuard â† {Predicate _ğ•£ p:
    Fâ†{resultâ€¿rest: Predicate result?resultâ€¿rest; âŸ¨âŸ©}p.Run
    MakeParser f
}
ParseSeq â† {
    Fâ†{
        âŸ¨âŸ©ğ•Šğ•©: âŸ¨âŸ¨âŸ©,ğ•©âŸ© ;
        ğ•¨ğ•Šğ•©:
            # â€¢Show ğ•¨â‹ˆğ•©
            pâ†âŠ‘ğ•¨
            psâ†1â†“ğ•¨
            {resultâ€¿rest: (<result)âŠ¸âˆ¾_MapParserResult (psâŠ¸F) rest; âŸ¨âŸ©}p.Run ğ•©
    }
    F2â†ğ•©âŠ¸F
    MakeParser f2
}
parseDigit â†  (-âŸœ'0')_MapParser ('0'âŠ¸â‰¤âˆ§â‰¤âŸœ'9')_ParseGuard parseChar
parseNumber â† {+Â´ğ•©Ã—10â‹†âŒ½â†•â‰ ğ•©}_MapParser ((0<â‰ )âˆ§(4>â‰ ))_ParseGuard ParseRepeat parseDigit
! âŸ¨123, "abc"âŸ© â‰¡ parseNumber.Run "123abc"

Part1 â† {
    input       â† ReadInput ğ•©
    parseMul    â† ParseSeq âŸ¨ParseLiteral "mul(", parseNumber, ParseLiteral ",", parseNumber, ParseLiteral ")"âŸ©
    +Â´ {âŸ¨Â·,m,Â·,n,Â·âŸ©â€¿Â·:mÃ—n;0}Â¨ parseMul.RunÂ¨ â†“input
}
part1test â† Part1 "day3testinput.txt"
â€¢Show part1test
! part1test = 161
part1result â† Part1 "day3input.txt"
â€¢Show part1result
!part1result = 188192787

# Part2 â† {
#     input   â† ReadInput ğ•©
#     input
# }
# part2test â† Part2 "day3testinput.txt"
# â€¢Show part2test
# ! part2test = 4
# part2result â† Part2 "day3input.txt"
# â€¢Show part2result
# ! part2result = 531
